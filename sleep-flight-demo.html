<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>âœˆï¸ ç¡çœ èˆªç­ç³»çµ± - å®Œæ•´æ¼”ç¤º</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            min-height: 100vh;
            padding: 20px;
        }

        .demo-container {
            max-width: 1200px;
            margin: 0 auto;
        }

        h1 {
            text-align: center;
            margin-bottom: 30px;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
            font-size: 2.5rem;
        }

        /* å°åŒ—ä½ç½®é¢æ¿æ¨£å¼ */
        .taipei-location-panel {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.15), rgba(255, 255, 255, 0.05));
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 25px;
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .location-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid rgba(255, 255, 255, 0.1);
        }

        .location-icon {
            font-size: 32px;
            margin-right: 15px;
            animation: bounce 2s ease-in-out infinite;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }

        .location-info h2 {
            margin: 0;
            font-size: 24px;
            color: #fff;
            font-weight: 700;
        }

        .location-subtitle {
            margin: 5px 0 0 0;
            font-size: 14px;
            color: rgba(255, 255, 255, 0.8);
            font-weight: 500;
        }

        .weather-info {
            display: flex;
            align-items: center;
            gap: 8px;
            background: rgba(255, 255, 255, 0.1);
            padding: 8px 15px;
            border-radius: 20px;
        }

        .weather-icon {
            font-size: 20px;
        }

        .weather-text {
            font-size: 16px;
            font-weight: 600;
            color: #fff;
        }

        .taipei-features {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .feature-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 15px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .feature-item:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .feature-icon {
            font-size: 24px;
            margin-bottom: 8px;
        }

        .feature-text {
            font-size: 12px;
            font-weight: 600;
            color: #fff;
            text-align: center;
        }

        .ai-generated-content {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 15px;
            padding: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .ai-content-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
        }

        .refresh-ai-btn {
            margin-left: auto;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 8px;
            padding: 5px 10px;
            color: white;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .refresh-ai-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: rotate(180deg);
        }

        .ai-icon {
            font-size: 20px;
            animation: spin 3s linear infinite;
        }

        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .ai-title {
            font-size: 16px;
            font-weight: 700;
            color: #00ff88;
        }

        .ai-content-text {
            font-size: 14px;
            line-height: 1.6;
            color: rgba(255, 255, 255, 0.9);
            min-height: 60px;
            display: flex;
            align-items: center;
        }

        .loading-ai {
            color: #00ff88;
            font-style: italic;
            animation: pulse 1.5s ease-in-out infinite;
        }

        .ai-fact {
            display: flex;
            align-items: flex-start;
            gap: 12px;
            animation: fadeInUp 0.5s ease-out;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .fact-icon {
            font-size: 18px;
            margin-top: 2px;
            flex-shrink: 0;
        }

        .fact-text {
            flex: 1;
            font-size: 14px;
            line-height: 1.6;
            color: rgba(255, 255, 255, 0.9);
        }

        .layout {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        .control-panel {
            background: rgba(255, 255, 255, 0.1);
            padding: 25px;
            border-radius: 20px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .demo-section {
            background: rgba(0, 0, 0, 0.2);
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
        }

        h3 {
            margin-top: 0;
            color: #00ff88;
            font-size: 18px;
            margin-bottom: 15px;
        }

        /* èµ·åºŠæ™‚é–“é¸æ“‡æ¨£å¼ */
        .wake-time-section {
            margin-bottom: 25px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .time-selector {
            display: flex;
            flex-direction: column;
            gap: 15px;
            align-items: center;
        }

        .time-input {
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 10px;
            padding: 12px 15px;
            color: white;
            font-size: 16px;
            font-weight: 600;
            text-align: center;
            width: 120px;
        }

        .time-presets {
            display: flex;
            gap: 10px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .time-preset {
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 8px;
            padding: 8px 16px;
            color: white;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .time-preset:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }

        .time-preset.active {
            background: linear-gradient(45deg, #00ff88, #00cc6f);
            border-color: #00ff88;
            color: #000;
        }

        .flight-info {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin-top: 15px;
        }

        .flight-info span {
            background: rgba(255, 255, 255, 0.1);
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 600;
            color: #00ff88;
        }

        /* ç›®çš„åœ°ç¶²æ ¼ */
        .destination-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .destination-option {
            background: linear-gradient(135deg, rgba(116, 185, 255, 0.9), rgba(9, 132, 227, 0.9));
            color: white;
            border: none;
            border-radius: 15px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 6px 20px rgba(116, 185, 255, 0.3);
            position: relative;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .destination-option:hover {
            transform: translateY(-8px) scale(1.02);
            box-shadow: 0 15px 35px rgba(116, 185, 255, 0.4);
        }

        .destination-option.selected {
            background: linear-gradient(135deg, rgba(0, 255, 136, 0.9), rgba(0, 204, 111, 0.9));
            box-shadow: 0 15px 35px rgba(0, 255, 136, 0.4);
            transform: scale(1.05);
        }

        .dest-flag-large {
            font-size: 48px;
            margin-bottom: 12px;
            filter: drop-shadow(0 3px 6px rgba(0, 0, 0, 0.3));
            animation: float 3s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-3px); }
        }

        .dest-info {
            flex: 1;
            margin-bottom: 12px;
        }

        .dest-name {
            font-size: 18px;
            font-weight: 700;
            margin-bottom: 4px;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }

        .dest-country {
            font-size: 13px;
            opacity: 0.9;
            margin-bottom: 8px;
            font-weight: 500;
        }

        .dest-phrase {
            font-size: 12px;
            opacity: 0.8;
            font-style: italic;
            line-height: 1.3;
            color: rgba(255, 255, 255, 0.9);
        }

        .dest-price {
            font-size: 16px;
            font-weight: 700;
            color: #00ff88;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
            background: rgba(0, 0, 0, 0.2);
            padding: 6px 12px;
            border-radius: 15px;
            border: 1px solid rgba(0, 255, 136, 0.3);
        }

        /* æŒ‰éˆ•æ¨£å¼ */
        button {
            padding: 12px 25px;
            margin: 5px;
            border: none;
            border-radius: 25px;
            background: linear-gradient(45deg, #00ff88, #00cc6f);
            color: #000;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(0, 255, 136, 0.3);
        }

        button:disabled {
            background: rgba(255, 255, 255, 0.2);
            color: rgba(255, 255, 255, 0.5);
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .secondary-btn {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.3);
        }

        .secondary-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }

        /* æ©Ÿç¥¨é è¦½ */
        .ticket-preview {
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            border-radius: 15px;
            padding: 25px;
            border: 2px solid #dee2e6;
            color: #2c3e50;
            margin-top: 20px;
        }

        .ticket-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #dee2e6;
        }

        .airline-info {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .airline-icon {
            font-size: 24px;
        }

        .airline-name {
            font-size: 18px;
            font-weight: 700;
            color: #667eea;
        }

        .route-info {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
        }

        .location-info {
            text-align: center;
        }

        .location-code {
            font-size: 24px;
            font-weight: 700;
            color: #667eea;
        }

        .location-name {
            font-size: 14px;
            color: #666;
        }

        .flight-arrow {
            font-size: 24px;
            color: #667eea;
            animation: fly 2s ease-in-out infinite;
        }

        @keyframes fly {
            0%, 100% { transform: translateX(0); }
            50% { transform: translateX(10px); }
        }

        .flight-details {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }

        .detail-item {
            display: flex;
            justify-content: space-between;
            padding: 10px;
            background: rgba(102, 126, 234, 0.1);
            border-radius: 8px;
        }

        .detail-label {
            font-size: 12px;
            color: #666;
            font-weight: 600;
        }

        .detail-value {
            font-size: 14px;
            font-weight: 700;
            color: #667eea;
        }

        /* æ—¥èªŒè¼¸å‡º */
        .log-output {
            background: rgba(0, 0, 0, 0.5);
            padding: 15px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            max-height: 300px;
            overflow-y: auto;
            color: #00ff88;
        }

        .log-line {
            margin: 5px 0;
            padding: 3px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .loading {
            text-align: center;
            padding: 40px 20px;
            font-size: 16px;
            color: #fff;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            margin: 20px 0;
        }

        .error {
            text-align: center;
            padding: 40px 20px;
            font-size: 16px;
            color: #ff6b6b;
            background: rgba(255, 107, 107, 0.1);
            border-radius: 15px;
            margin: 20px 0;
        }

        /* è¨ˆç®—æ­¥é©Ÿæ¨£å¼ */
        .calculation-step {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 15px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            animation: slideInUp 0.5s ease-out;
        }

        @keyframes slideInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .step-content {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .step-icon {
            font-size: 24px;
            min-width: 40px;
            text-align: center;
            animation: pulse 2s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .step-text {
            flex: 1;
            font-size: 16px;
            font-weight: 600;
            color: #fff;
        }

        .step-progress {
            min-width: 120px;
            text-align: center;
        }

        .progress-bar {
            width: 100px;
            height: 6px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 3px;
            overflow: hidden;
            margin-bottom: 5px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(45deg, #00ff88, #00cc6f);
            border-radius: 3px;
            transition: width 0.1s ease;
            position: relative;
        }

        .progress-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            animation: shimmer 1.5s ease-in-out infinite;
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        .progress-text {
            font-size: 12px;
            font-weight: 700;
            color: #00ff88;
        }

        .loading.success {
            background: rgba(0, 255, 136, 0.1);
            border: 1px solid rgba(0, 255, 136, 0.3);
            color: #00ff88;
            animation: successPulse 1s ease-in-out infinite;
        }

        @keyframes successPulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        /* éŸ¿æ‡‰å¼è¨­è¨ˆ */
        @media (max-width: 900px) {
            .layout {
                grid-template-columns: 1fr;
            }
            
            .destination-grid {
                grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
                gap: 12px;
            }
            
            .destination-option {
                padding: 20px;
            }
            
            .dest-flag-large {
                font-size: 48px;
            }
            
            .dest-name {
                font-size: 18px;
            }
            
            .flight-details {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 600px) {
            .destination-grid {
                grid-template-columns: 1fr;
            }
            
            .dest-flag-large {
                font-size: 40px;
            }
            
            .dest-name {
                font-size: 16px;
            }
            
            .dest-phrase {
                font-size: 12px;
            }
        }

        /* å›ºå®šå³ä¸‹è§’èµ·é£›æŒ‰éˆ•ï¼ˆæ¢å¾©é¡¯ç¤ºï¼‰ */
        .fixed-action-button {
            position: fixed;
            bottom: 30px;
            right: 30px;
            z-index: 9999999;
        }

        .action-btn {
            background: linear-gradient(135deg, #00ff88, #00cc6f);
            border: none;
            border-radius: 20px;
            padding: 14px 28px;
            color: #000;
            font-size: 14px;
            font-weight: 700;
            cursor: pointer;
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.2);
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            min-width: 150px;
            justify-content: center;
        }

        .action-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 24px rgba(0, 0, 0, 0.25);
        }
    </style>
</head>
<body>
    <div class="demo-container">
        <h1>âœˆï¸ ç¡çœ èˆªç­ç³»çµ± - å®Œæ•´æ¼”ç¤º</h1>
        
        <!-- å°åŒ—ä½ç½®é¡¯ç¤ºå€åŸŸ -->
        <div class="taipei-location-panel">
            <div class="location-header">
                <div class="location-icon">ğŸ“</div>
                <div class="location-info">
                    <h2>ç•¶å‰ä½ç½®ï¼šå°åŒ—</h2>
                    <p class="location-subtitle">Taipei, Taiwan ğŸ‡¹ğŸ‡¼</p>
                </div>
                <div class="weather-info">
                    <div class="weather-icon">â˜€ï¸</div>
                    <div class="weather-text">25Â°C</div>
                </div>
            </div>
            
            <div class="taipei-features">
                <div class="feature-item">
                    <span class="feature-icon">ğŸ®</span>
                    <span class="feature-text">å¤œå¸‚æ–‡åŒ–</span>
                </div>
                <div class="feature-item">
                    <span class="feature-icon">ğŸ¢</span>
                    <span class="feature-text">101å¤§æ¨“</span>
                </div>
                <div class="feature-item">
                    <span class="feature-icon">ğŸœ</span>
                    <span class="feature-text">å°ç± åŒ…</span>
                </div>
                <div class="feature-item">
                    <span class="feature-icon">ğŸš‡</span>
                    <span class="feature-text">æ·é‹ç³»çµ±</span>
                </div>
            </div>
            
            <div class="ai-generated-content">
                <div class="ai-content-header">
                    <span class="ai-icon">ğŸ¤–</span>
                    <span class="ai-title">AI å°åŒ—å°çŸ¥è­˜</span>
                    <button class="refresh-ai-btn" onclick="refreshAIContent()">ğŸ”„</button>
                </div>
                <div class="ai-content-text" id="aiContentText">
                    <div class="loading-ai">ğŸ”„ AIæ­£åœ¨ç”Ÿæˆå°åŒ—å°çŸ¥è­˜...</div>
                </div>
            </div>
        </div>

        <div class="layout">
            <!-- å·¦å´ï¼šæ§åˆ¶é¢æ¿ -->
            <div class="control-panel">
                <div class="demo-section">
                    <h3>ğŸ• èµ·åºŠæ™‚é–“é¸æ“‡</h3>
                    
                    <div class="wake-time-section">
                        <div class="time-selector">
                            <input type="time" id="wakeTimeInput" class="time-input" value="08:00">
                            <div class="time-presets">
                                <button class="time-preset" data-time="06:00">6:00</button>
                                <button class="time-preset" data-time="07:00">7:00</button>
                                <button class="time-preset active" data-time="08:00">8:00</button>
                                <button class="time-preset" data-time="09:00">9:00</button>
                                <button class="time-preset" data-time="10:00">10:00</button>
                            </div>
                        </div>
                        <div class="flight-info">
                            <span class="flight-duration">â±ï¸ é£›è¡Œæ™‚é–“ï¼š8å°æ™‚</span>
                            <span class="flight-distance">ğŸ“ æœ€å¤§è·é›¢ï¼š6400å…¬é‡Œ</span>
                        </div>
                    </div>
                    
                    <button onclick="loadDestinations()" class="secondary-btn">ğŸ”„ é‡æ–°è¨ˆç®—ç›®çš„åœ°</button>
                    <button onclick="debugDestinations()" class="secondary-btn">ğŸ› èª¿è©¦ç›®çš„åœ°</button>
                    <button onclick="testDestinations()" class="secondary-btn">ğŸ§ª æ¸¬è©¦ç›®çš„åœ°</button>
                </div>
                
                <div class="demo-section">
                    <h3>ğŸŒ å¯é”ç›®çš„åœ°</h3>
                    <div class="destination-grid" id="destinationGrid">
                        <div class="loading">ğŸ”„ æ­£åœ¨è¨ˆç®—å¯é”ç›®çš„åœ°...</div>
                    </div>
                </div>
                
                <div class="demo-section">
                    <h3>ğŸ« æ©Ÿç¥¨æ“ä½œ</h3>
                    <button id="confirmTicket" onclick="confirmTicket()" disabled>âœˆï¸ ç¢ºèªæ©Ÿç¥¨</button>
                    <button onclick="clearSelection()" class="secondary-btn">ğŸ”„ é‡æ–°é¸æ“‡</button>
                </div>
                
                <div class="demo-section">
                    <h3>ğŸµ èªéŸ³æ¸¬è©¦</h3>
                    <button onclick="testBoardingAnnouncement()" class="secondary-btn">ğŸ¤ æ¸¬è©¦ç™»æ©Ÿå»£æ’­</button>
                    <button onclick="testLandingAnnouncement()" class="secondary-btn">ğŸ¤ æ¸¬è©¦é™è½å»£æ’­</button>
                </div>
                
                <div class="demo-section">
                    <h3>ğŸ“Š ç³»çµ±æ—¥èªŒ</h3>
                    <div id="logOutput" class="log-output">
                        <div class="log-line">ç³»çµ±å·²å•Ÿå‹•ï¼Œç­‰å¾…æ“ä½œ...</div>
                    </div>
                    <button onclick="clearLog()" class="secondary-btn">æ¸…é™¤æ—¥èªŒ</button>
                </div>
            </div>
            
            <!-- å³å´ï¼šæ©Ÿç¥¨é è¦½ -->
            <div class="control-panel">
                <div class="demo-section">
                    <h3>âœˆï¸ æ©Ÿç¥¨é è¦½</h3>
                    <div id="ticketPreview" class="ticket-preview" style="display: none;">
                        <div class="ticket-header">
                            <div class="airline-info">
                                <span class="airline-icon">âœˆï¸</span>
                                <span class="airline-name">WAKE UP AIRLINES</span>
                            </div>
                            <div style="font-size: 12px; color: #666;">BOARDING PASS</div>
                        </div>
                        
                        <div class="route-info">
                            <div class="location-info">
                                <div class="location-code">TPE</div>
                                <div class="location-name">å°åŒ—</div>
                            </div>
                            <div class="flight-arrow">âœˆï¸</div>
                            <div class="location-info">
                                <div class="location-code" id="destinationCode">XXX</div>
                                <div class="location-name" id="destinationName">ç›®çš„åœ°</div>
                            </div>
                        </div>
                        
                        <div class="flight-details">
                            <div class="detail-item">
                                <span class="detail-label">FLIGHT</span>
                                <span class="detail-value" id="flightNumber">WU-0000</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">DATE</span>
                                <span class="detail-value" id="departureDate">2024-01-01</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">DEPARTURE</span>
                                <span class="detail-value">11:30</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">ARRIVAL</span>
                                <span class="detail-value" id="arrivalTime">éš”å¤© 08:00</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">PRICE</span>
                                <span class="detail-value" id="ticketPrice">NT$ 0</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">DURATION</span>
                                <span class="detail-value" id="flightDuration">8h</span>
                            </div>
                        </div>
                    </div>
                    
                    <div id="noTicketMessage" style="text-align: center; padding: 40px; color: rgba(255,255,255,0.6);">
                        è«‹é¸æ“‡ç›®çš„åœ°ä»¥é è¦½æ©Ÿç¥¨
                    </div>
                </div>
                
                <div class="demo-section">
                    <h3>ğŸ® éŠæˆ²ç‹€æ…‹</h3>
                    <div style="background: rgba(0,0,0,0.2); padding: 15px; border-radius: 10px;">
                        <div style="margin-bottom: 10px;">
                            <span style="color: #00ff88;">ğŸ’° é‡‘éŒ¢:</span>
                            <span id="gameMoney">NT$ 10,000</span>
                        </div>
                        <div style="margin-bottom: 10px;">
                            <span style="color: #00ff88;">â›½ ç‡ƒæ–™:</span>
                            <span id="gameFuel">1000/1000</span>
                        </div>
                        <div>
                            <span style="color: #00ff88;">ğŸ« å·²é¸æ“‡:</span>
                            <span id="selectedDestination">ç„¡</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- å›ºå®šå³ä¸‹è§’ï¼šæº–å‚™èµ·é£›æŒ‰éˆ•ï¼ˆæ¢å¾©ï¼‰ -->
    <div class="fixed-action-button" id="fixedActionButton">
        <button class="action-btn" onclick="handleActionButton()">
            <span class="btn-icon">âœˆï¸</span>
            <span class="btn-text">æº–å‚™èµ·é£›</span>
        </button>
    </div>

    <script>
        // ç¡çœ èˆªç­ç³»çµ±
        class SleepFlightDemo {
            constructor() {
                this.currentLocation = {
                    name: 'å°åŒ—',
                    country: 'å°ç£',
                    coordinates: [25.0330, 121.5654]
                };
                this.wakeTime = '08:00';
                this.selectedDestination = null;
                this.destinations = [];
                this.gameState = {
                    money: 10000,
                    fuel: 1000
                };
                
                this.init();
            }

            init() {
                this.setupEventListeners();
                this.updateFlightInfo(); // åˆå§‹åŒ–é£›è¡Œä¿¡æ¯
                this.loadDestinations();
                this.generateAIContent(); // ç”ŸæˆAIå…§å®¹
                this.setupTaipeiFeatures(); // è¨­ç½®å°åŒ—ç‰¹è‰²åŠŸèƒ½
                this.log('ç³»çµ±åˆå§‹åŒ–å®Œæˆ');
            }

            setupEventListeners() {
                // æ™‚é–“è¼¸å…¥è®ŠåŒ–
                document.getElementById('wakeTimeInput').addEventListener('change', (e) => {
                    this.updateWakeTime(e.target.value);
                });

                // æ™‚é–“é è¨­æŒ‰éˆ•
                document.querySelectorAll('.time-preset').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        this.selectTimePreset(e.target.dataset.time);
                    });
                });
            }

            updateWakeTime(time) {
                this.wakeTime = time;
                this.log(`èµ·åºŠæ™‚é–“æ›´æ–°ç‚º: ${time}`);
                
                // æ›´æ–°é è¨­æŒ‰éˆ•ç‹€æ…‹
                document.querySelectorAll('.time-preset').forEach(btn => {
                    btn.classList.remove('active');
                    if (btn.dataset.time === time) {
                        btn.classList.add('active');
                    }
                });
                
                // æ›´æ–°é£›è¡Œä¿¡æ¯é¡¯ç¤º
                this.updateFlightInfo();
            }

            updateFlightInfo() {
                // ç°¡åŒ–é‚è¼¯ - å›ºå®š8å°æ™‚é£›è¡Œæ™‚é–“
                const flightDuration = 8;
                const maxDistance = flightDuration * 800;
                
                document.querySelector('.flight-duration').textContent = `â±ï¸ é£›è¡Œæ™‚é–“ï¼š${flightDuration}å°æ™‚`;
                document.querySelector('.flight-distance').textContent = `ğŸ“ æœ€å¤§è·é›¢ï¼š${maxDistance}å…¬é‡Œ`;
            }

            selectTimePreset(time) {
                document.getElementById('wakeTimeInput').value = time;
                this.updateWakeTime(time);
            }

            async loadDestinations() {
                const grid = document.getElementById('destinationGrid');
                
                // é¡¯ç¤ºè¨ˆç®—éç¨‹
                await this.showCalculationProcess(grid);
                
                try {
                    this.destinations = this.calculateSleepFlightDestinations();
                    await this.renderDestinations();
                    this.log(`è¼‰å…¥ ${this.destinations.length} å€‹å¯é”ç›®çš„åœ°`);
                } catch (error) {
                    grid.innerHTML = '<div class="error">âŒ è¼‰å…¥ç›®çš„åœ°å¤±æ•—</div>';
                    this.log(`è¼‰å…¥ç›®çš„åœ°å¤±æ•—: ${error.message}`);
                }
            }

            async showCalculationProcess(grid) {
                const steps = [
                    { text: 'ğŸ“ æ­£åœ¨ç²å–ç•¶å‰ä½ç½®...', duration: 800 },
                    { text: 'ğŸŒ å¾å…¨çƒåŸå¸‚APIç²å–æ•¸æ“š...', duration: 1200 },
                    { text: 'ğŸ“ è¨ˆç®—8å°æ™‚èˆªç¨‹è·é›¢ç¯„åœ...', duration: 1000 },
                    { text: 'â° æ ¹æ“šèµ·åºŠæ™‚é–“ç¯©é¸æ™‚å€...', duration: 900 },
                    { text: 'ğŸ¯ é¸æ“‡4å€‹æœ€ä½³ç›®çš„åœ°...', duration: 700 },
                    { text: 'ğŸ’° è¨ˆç®—æ©Ÿç¥¨åƒ¹æ ¼å’Œé£›è¡Œæ™‚é–“...', duration: 600 }
                ];

                for (let i = 0; i < steps.length; i++) {
                    const step = steps[i];
                    
                    // å‰µå»ºæ­¥é©Ÿå®¹å™¨
                    const stepContainer = document.createElement('div');
                    stepContainer.className = 'calculation-step';
                    stepContainer.innerHTML = `
                        <div class="step-content">
                            <div class="step-icon">${this.getStepIcon(i)}</div>
                            <div class="step-text">${step.text}</div>
                            <div class="step-progress">
                                <div class="progress-bar">
                                    <div class="progress-fill" style="width: 0%"></div>
                                </div>
                                <div class="progress-text">0%</div>
                            </div>
                        </div>
                    `;
                    
                    grid.innerHTML = '';
                    grid.appendChild(stepContainer);
                    
                    // å‹•ç•«é€²åº¦æ¢
                    await this.animateProgress(stepContainer, step.duration);
                    
                    // çŸ­æš«åœé “
                    await new Promise(resolve => setTimeout(resolve, 200));
                }
                
                // æœ€å¾Œé¡¯ç¤ºå®Œæˆç‹€æ…‹
                grid.innerHTML = '<div class="loading success">âœ… è¨ˆç®—å®Œæˆï¼æ­£åœ¨è¼‰å…¥ç›®çš„åœ°...</div>';
                await new Promise(resolve => setTimeout(resolve, 500));
            }

            getStepIcon(stepIndex) {
                const icons = ['ğŸ“', 'ğŸŒ', 'ğŸ“', 'â°', 'ğŸ¯', 'ğŸ’°'];
                return icons[stepIndex] || 'ğŸ”„';
            }

            async animateProgress(container, duration) {
                const progressFill = container.querySelector('.progress-fill');
                const progressText = container.querySelector('.progress-text');
                
                return new Promise(resolve => {
                    let progress = 0;
                    const interval = setInterval(() => {
                        progress += 2;
                        if (progress > 100) {
                            progress = 100;
                            clearInterval(interval);
                            resolve();
                        }
                        
                        progressFill.style.width = `${progress}%`;
                        progressText.textContent = `${progress}%`;
                    }, duration / 50);
                });
            }

            calculateSleepFlightDestinations() {
                console.log('é–‹å§‹è¨ˆç®—ç›®çš„åœ°ï¼Œèµ·åºŠæ™‚é–“:', this.wakeTime);
                
                // ç²å–ç•¶å‰ä½ç½®
                const currentLocation = this.getCurrentLocation();
                console.log('ç•¶å‰ä½ç½®:', currentLocation);
                
                // ç²å–æ‰€æœ‰å¯ç”¨åŸå¸‚
                const allCities = this.getAllCities();
                console.log('å¯ç”¨åŸå¸‚æ•¸é‡:', allCities.length);
                
                // éæ¿¾8å°æ™‚èˆªç¨‹å…§çš„åŸå¸‚
                const reachableCities = this.filterByFlightRange(currentLocation, allCities);
                console.log('8å°æ™‚èˆªç¨‹å…§åŸå¸‚æ•¸é‡:', reachableCities.length);
                
                // é¸æ“‡4å€‹æœ€ä½³ç›®çš„åœ°
                const selectedDestinations = this.selectBestDestinations(reachableCities, currentLocation);
                console.log('æœ€çµ‚é¸æ“‡çš„4å€‹ç›®çš„åœ°:', selectedDestinations);
                
                return selectedDestinations;
            }

            // Haversineå…¬å¼è¨ˆç®—å…©é»é–“è·é›¢
            calculateDistance(lat1, lon1, lat2, lon2) {
                const R = 6371; // åœ°çƒåŠå¾‘(å…¬é‡Œ)
                const dLat = (lat2 - lat1) * Math.PI / 180;
                const dLon = (lon2 - lon1) * Math.PI / 180;
                const a = Math.sin(dLat/2) * Math.sin(dLat/2) +
                          Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) *
                          Math.sin(dLon/2) * Math.sin(dLon/2);
                const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
                return R * c;
            }


            // éæ¿¾8å°æ™‚èˆªç¨‹å…§çš„åŸå¸‚
            filterByFlightRange(currentLocation, cities) {
                const flightDuration = 8; // å°æ™‚
                const flightSpeed = 800; // å…¬é‡Œ/å°æ™‚
                const maxDistance = flightDuration * flightSpeed; // 6400å…¬é‡Œ
                
                return cities.filter(city => {
                    const distance = this.calculateDistance(
                        currentLocation.coordinates[0], currentLocation.coordinates[1],
                        city.latitude, city.longitude
                    );
                    
                    // æ·»åŠ è·é›¢åˆ°åŸå¸‚å°è±¡
                    city.distance = Math.round(distance);
                    city.flightTime = Math.round((distance / flightSpeed) * 10) / 10;
                    
                    return distance <= maxDistance;
                });
            }

            // é¸æ“‡4å€‹æœ€ä½³ç›®çš„åœ°
            selectBestDestinations(cities, currentLocation) {
                if (cities.length === 0) {
                    // å¦‚æœæ²’æœ‰ç¬¦åˆæ¢ä»¶çš„åŸå¸‚ï¼Œè¿”å›å‰4å€‹åŸå¸‚
                    const allCities = this.getAllCities();
                    return allCities.slice(0, 4).map(city => ({
                        id: city.id,
                        name: city.name,
                        country: city.country,
                        countryCode: city.countryCode,
                        flag: this.getCountryFlag(city.countryCode),
                        distance: Math.round(this.calculateDistance(currentLocation.coordinates[0], currentLocation.coordinates[1], city.latitude, city.longitude)),
                        flightTime: Math.round((this.calculateDistance(currentLocation.coordinates[0], currentLocation.coordinates[1], city.latitude, city.longitude) / 800) * 10) / 10,
                        coordinates: [city.latitude, city.longitude],
                        price: this.calculateFlightPrice(this.calculateDistance(currentLocation.coordinates[0], currentLocation.coordinates[1], city.latitude, city.longitude)),
                        timezone: city.timezone
                    }));
                }
                
                // æŒ‰è·é›¢æ’åºï¼Œé¸æ“‡ä¸åŒè·é›¢ç¯„åœçš„åŸå¸‚
                const sortedCities = cities.sort((a, b) => a.distance - b.distance);
                
                // é¸æ“‡ç­–ç•¥ï¼šè¿‘ã€ä¸­è¿‘ã€ä¸­é ã€é å„ä¸€å€‹
                const selected = [];
                const ranges = [
                    { min: 0, max: 2000 },      // è¿‘è·é›¢
                    { min: 2000, max: 4000 },    // ä¸­è¿‘è·é›¢
                    { min: 4000, max: 6000 },    // ä¸­é è·é›¢
                    { min: 6000, max: 6400 }     // é è·é›¢
                ];
                
                ranges.forEach(range => {
                    const citiesInRange = sortedCities.filter(city => 
                        city.distance >= range.min && city.distance < range.max
                    );
                    
                    if (citiesInRange.length > 0) {
                        // éš¨æ©Ÿé¸æ“‡è©²ç¯„åœå…§çš„ä¸€å€‹åŸå¸‚
                        const randomIndex = Math.floor(Math.random() * citiesInRange.length);
                        selected.push(citiesInRange[randomIndex]);
                    }
                });
                
                // å¦‚æœæ²’æœ‰é¸å¤ 4å€‹ï¼Œå¾å‰©é¤˜åŸå¸‚ä¸­éš¨æ©Ÿè£œå……
                while (selected.length < 4 && sortedCities.length > selected.length) {
                    const remainingCities = sortedCities.filter(city => 
                        !selected.some(selected => selected.id === city.id)
                    );
                    
                    if (remainingCities.length > 0) {
                        const randomIndex = Math.floor(Math.random() * remainingCities.length);
                        selected.push(remainingCities[randomIndex]);
                    } else {
                        break;
                    }
                }
                
                // æ ¼å¼åŒ–ç‚ºç›®çš„åœ°å°è±¡
                return selected.map(city => ({
                    id: city.id || city.name.toLowerCase().replace(/\s+/g, ''),
                    name: city.name,
                    country: city.country,
                    countryCode: city.countryCode,
                    flag: this.getCountryFlag(city.countryCode),
                    distance: city.distance,
                    flightTime: city.flightTime,
                    coordinates: [city.latitude, city.longitude],
                    price: this.calculateFlightPrice(city.distance),
                    timezone: city.timezone || this.getDestinationUTCOffset(city.countryCode)
                }));
            }



            // è¨ˆç®—æ©Ÿç¥¨åƒ¹æ ¼
            calculateFlightPrice(distance) {
                const basePrice = 1500;
                const pricePerKm = 0.8;
                return Math.round(basePrice + (distance * pricePerKm));
            }

            // ç²å–åœ‹å®¶åœ‹æ——
            getCountryFlag(countryCode) {
                const flagMap = {
                    'JP': 'ğŸ‡¯ğŸ‡µ', 'KR': 'ğŸ‡°ğŸ‡·', 'TH': 'ğŸ‡¹ğŸ‡­', 'SG': 'ğŸ‡¸ğŸ‡¬', 'HK': 'ğŸ‡­ğŸ‡°',
                    'PH': 'ğŸ‡µğŸ‡­', 'MY': 'ğŸ‡²ğŸ‡¾', 'ID': 'ğŸ‡®ğŸ‡©', 'VN': 'ğŸ‡»ğŸ‡³', 'TW': 'ğŸ‡¹ğŸ‡¼',
                    'CN': 'ğŸ‡¨ğŸ‡³', 'AU': 'ğŸ‡¦ğŸ‡º', 'US': 'ğŸ‡ºğŸ‡¸', 'GB': 'ğŸ‡¬ğŸ‡§', 'FR': 'ğŸ‡«ğŸ‡·',
                    'DE': 'ğŸ‡©ğŸ‡ª', 'IT': 'ğŸ‡®ğŸ‡¹', 'ES': 'ğŸ‡ªğŸ‡¸', 'RU': 'ğŸ‡·ğŸ‡º', 'IN': 'ğŸ‡®ğŸ‡³'
                };
                return flagMap[countryCode] || 'ğŸŒ';
            }

            getUTCOffsetFromWakeTime(wakeTime) {
                const [hours, minutes] = wakeTime.split(':').map(Number);
                const totalMinutes = hours * 60 + minutes;
                return Math.round((totalMinutes - 480) / 60); // 480åˆ†é˜ = 8å°æ™‚
            }

            getDestinationUTCOffset(countryCode) {
                const offsetMap = {
                    'JP': 9, 'KR': 9, 'TH': 7, 'SG': 8, 'HK': 8,
                    'PH': 8, 'CN': 8, 'TW': 8, 'MY': 8, 'ID': 7
                };
                return offsetMap[countryCode] || 8;
            }

            async renderDestinations() {
                const grid = document.getElementById('destinationGrid');
                grid.innerHTML = '';

                for (const dest of this.destinations) {
                    const button = document.createElement('button');
                    button.className = 'destination-option';
                    button.dataset.destination = dest.id;
                    
                    // ç”Ÿæˆå¸å¼•äººçš„çŸ­å¥
                    const attractivePhrase = await this.generateAttractivePhrase(dest);
                    
                    button.innerHTML = `
                        <div class="dest-flag-large">${dest.flag}</div>
                        <div class="dest-info">
                            <div class="dest-name">${dest.name}</div>
                            <div class="dest-country">${dest.country}</div>
                            <div class="dest-phrase">${attractivePhrase}</div>
                        </div>
                        <div class="dest-price">NT$ ${dest.price.toLocaleString()}</div>
                    `;

                    button.addEventListener('click', () => {
                        this.selectDestination(dest);
                    });

                    grid.appendChild(button);
                }
            }

            async generateAttractivePhrase(destination) {
                const phrases = {
                    'tokyo': 'æš¢éŠäº¬éƒ½ï¼Œé«”é©—å’Œé¢¨ä¹‹ç¾',
                    'seoul': 'æ¢ç´¢é¦–çˆ¾ï¼Œæ„Ÿå—éŸ“æµé­…åŠ›',
                    'bangkok': 'æ¼«æ­¥æ›¼è°·ï¼Œå“å‘³æ³°å¼é¢¨æƒ…',
                    'singapore': 'ç…åŸä¹‹æ—…ï¼Œç¾ä»£èˆ‡å‚³çµ±äº¤è',
                    'hongkong': 'æ±æ–¹ä¹‹ç ï¼Œç’€ç’¨å¤œæ™¯ç­‰ä½ ',
                    'manila': 'é¦¬å°¼æ‹‰ç£ï¼Œç†±å¸¶æµ·å³¶é¢¨å…‰',
                    'kualalumpur': 'é›™å­å¡”ä¸‹ï¼Œé¦¬ä¾†è¥¿äºé¢¨æƒ…',
                    'jakarta': 'é›…åŠ é”å¤œï¼Œå°å°¼æ–‡åŒ–é«”é©—',
                    'hochiminh': 'èƒ¡å¿—æ˜å¸‚ï¼Œè¶Šå—æ­·å²èˆ‡ç¾ä»£',
                    'taipei': 'å°åŒ—101ï¼Œå°ç£ç¾é£Ÿå¤©å ‚'
                };

                // å¦‚æœæœ‰é è¨­çŸ­å¥å°±ä½¿ç”¨ï¼Œå¦å‰‡ç”Ÿæˆéš¨æ©Ÿçš„
                if (phrases[destination.id]) {
                    return phrases[destination.id];
                }

                // æ ¹æ“šåœ‹å®¶ç”Ÿæˆé€šç”¨çŸ­å¥
                const countryPhrases = {
                    'æ—¥æœ¬': 'æ«»èŠ±é£›èˆï¼Œå’Œé¢¨é›…éŸ»',
                    'éŸ“åœ‹': 'éŸ“æµé­…åŠ›ï¼Œæ™‚å°šä¹‹éƒ½',
                    'æ³°åœ‹': 'å¾®ç¬‘åœ‹åº¦ï¼Œç†±å¸¶å¤©å ‚',
                    'æ–°åŠ å¡': 'èŠ±åœ’åŸå¸‚ï¼Œå¤šå…ƒæ–‡åŒ–',
                    'é¦™æ¸¯': 'æ±æ–¹æ˜ç ï¼Œè³¼ç‰©å¤©å ‚',
                    'è²å¾‹è³“': 'åƒå³¶ä¹‹åœ‹ï¼Œç†±å¸¶é¢¨æƒ…',
                    'é¦¬ä¾†è¥¿äº': 'å¤šå…ƒæ–‡åŒ–ï¼Œç†±å¸¶é›¨æ—',
                    'å°å°¼': 'è¬å³¶ä¹‹åœ‹ï¼Œç«å±±èˆ‡æµ·ç˜',
                    'è¶Šå—': 'æ­·å²æ‚ ä¹…ï¼Œç¾é£Ÿå¤©å ‚'
                };

                return countryPhrases[destination.country] || 'æ¢ç´¢æ–°ä¸–ç•Œï¼Œé–‹å•Ÿæ–°æ—…ç¨‹';
            }

            selectDestination(destination) {
                // æ›´æ–°é¸ä¸­ç‹€æ…‹
                document.querySelectorAll('.destination-option').forEach(btn => {
                    btn.classList.remove('selected');
                });
                document.querySelector(`[data-destination="${destination.id}"]`).classList.add('selected');

                this.selectedDestination = destination;
                this.updateTicketPreview(destination);
                this.updateGameState();
                
                document.getElementById('confirmTicket').disabled = false;
                this.log(`é¸æ“‡ç›®çš„åœ°: ${destination.flag} ${destination.name}`);
            }

            updateTicketPreview(destination) {
                document.getElementById('destinationCode').textContent = destination.countryCode;
                document.getElementById('destinationName').textContent = destination.name;
                document.getElementById('arrivalTime').textContent = `éš”å¤© ${this.wakeTime}`;
                document.getElementById('ticketPrice').textContent = `NT$ ${destination.price.toLocaleString()}`;
                document.getElementById('flightDuration').textContent = `${destination.flightTime}h`;
                document.getElementById('departureDate').textContent = new Date().toISOString().split('T')[0];
                document.getElementById('flightNumber').textContent = `WU-${Math.floor(Math.random() * 9000) + 1000}`;
                
                document.getElementById('ticketPreview').style.display = 'block';
                document.getElementById('noTicketMessage').style.display = 'none';
            }

            updateGameState() {
                document.getElementById('selectedDestination').textContent = 
                    this.selectedDestination ? `${this.selectedDestination.flag} ${this.selectedDestination.name}` : 'ç„¡';
            }

            async confirmTicket() {
                if (!this.selectedDestination) return;

                const destination = this.selectedDestination;
                
                // æª¢æŸ¥é‡‘éŒ¢
                if (this.gameState.money < destination.price) {
                    alert(`ğŸ’° é‡‘éŒ¢ä¸è¶³ï¼éœ€è¦ NT$ ${destination.price.toLocaleString()}ï¼Œæ‚¨åªæœ‰ NT$ ${this.gameState.money.toLocaleString()}`);
                    return;
                }

                // æ‰£é™¤é‡‘éŒ¢
                this.gameState.money -= destination.price;
                
                // æ›´æ–°é¡¯ç¤º
                document.getElementById('gameMoney').textContent = `NT$ ${this.gameState.money.toLocaleString()}`;
                
                this.log(`æ©Ÿç¥¨ç¢ºèªæˆåŠŸ: ${destination.flag} ${destination.name}`);
                this.log(`èŠ±è²»: NT$ ${destination.price.toLocaleString()}`);
                this.log(`å‰©é¤˜é‡‘éŒ¢: NT$ ${this.gameState.money.toLocaleString()}`);
                
                // æ’­æ”¾ç™»æ©Ÿå»£æ’­
                await this.playBoardingAnnouncement(destination);
                
                alert(`âœˆï¸ æ©Ÿç¥¨è³¼è²·æˆåŠŸï¼\n\nğŸ« ç›®çš„åœ°ï¼š${destination.flag} ${destination.name}\nğŸ’° èŠ±è²»ï¼šNT$ ${destination.price.toLocaleString()}\nğŸ• æŠµé”æ™‚é–“ï¼šéš”å¤© ${this.wakeTime}\n\nğŸŒ™ ç¥æ‚¨æœ‰å€‹ç¾å¥½çš„ç¡çœ ï¼`);
            }

            async playBoardingAnnouncement(destination) {
                try {
                    const announcement = `æ­¡è¿æ­ä¹˜ Wake Up Airlinesï¼æˆ‘å€‘å³å°‡å¾ ${this.currentLocation.name} é£›å¾€ ${destination.name}ï¼Œé£›è¡Œæ™‚é–“ ${destination.flightTime} å°æ™‚ã€‚è«‹æº–å‚™å¥½æ‚¨çš„å¤¢æƒ³ï¼Œæˆ‘å€‘å³å°‡èµ·é£›ï¼`;
                    
                    // ä½¿ç”¨ç€è¦½å™¨TTS
                    if ('speechSynthesis' in window) {
                        const utterance = new SpeechSynthesisUtterance(announcement);
                        utterance.lang = 'zh-TW';
                        utterance.rate = 0.9;
                        utterance.pitch = 1;
                        speechSynthesis.speak(utterance);
                    }
                    
                    this.log(`æ’­æ”¾ç™»æ©Ÿå»£æ’­: ${announcement}`);
                } catch (error) {
                    this.log(`æ’­æ”¾ç™»æ©Ÿå»£æ’­å¤±æ•—: ${error.message}`);
                }
            }

            async playLandingAnnouncement() {
                if (!this.selectedDestination) return;
                
                try {
                    const destination = this.selectedDestination;
                    const announcement = `å„ä½æ—…å®¢ï¼Œé£›æ©Ÿå³å°‡é™è½åœ¨ ${destination.name}ã€‚è«‹ç¹«å¥½å®‰å…¨å¸¶ï¼Œæº–å‚™é™è½ã€‚å¦‚æœæ‚¨æº–å‚™å¥½äº†ï¼Œè«‹æŒ‰æŒ‰éˆ•ç¢ºèªé™è½ã€‚`;
                    
                    // ä½¿ç”¨ç€è¦½å™¨TTS
                    if ('speechSynthesis' in window) {
                        const utterance = new SpeechSynthesisUtterance(announcement);
                        utterance.lang = 'zh-TW';
                        utterance.rate = 0.9;
                        utterance.pitch = 1;
                        speechSynthesis.speak(utterance);
                    }
                    
                    this.log(`æ’­æ”¾é™è½å»£æ’­: ${announcement}`);
                } catch (error) {
                    this.log(`æ’­æ”¾é™è½å»£æ’­å¤±æ•—: ${error.message}`);
                }
            }

            clearSelection() {
                this.selectedDestination = null;
                document.querySelectorAll('.destination-option').forEach(btn => {
                    btn.classList.remove('selected');
                });
                document.getElementById('confirmTicket').disabled = true;
                document.getElementById('ticketPreview').style.display = 'none';
                document.getElementById('noTicketMessage').style.display = 'block';
                this.updateGameState();
                this.log('æ¸…é™¤é¸æ“‡');
            }

            log(message) {
                const logDiv = document.getElementById('logOutput');
                const timestamp = new Date().toLocaleTimeString();
                const logLine = document.createElement('div');
                logLine.className = 'log-line';
                logLine.textContent = `[${timestamp}] ${message}`;
                
                logDiv.insertBefore(logLine, logDiv.firstChild);
                
                // é™åˆ¶æ—¥èªŒæ•¸é‡
                while (logDiv.children.length > 50) {
                    logDiv.removeChild(logDiv.lastChild);
                }
            }

            clearLog() {
                document.getElementById('logOutput').innerHTML = '<div class="log-line">æ—¥èªŒå·²æ¸…é™¤</div>';
            }

            async generateAIContent() {
                try {
                    // æ¨¡æ“¬AIç”Ÿæˆå»¶é²
                    await new Promise(resolve => setTimeout(resolve, 2000));
                    
                    const taipeiFacts = [
                        "ä½ çŸ¥é“å—ï¼Ÿå°åŒ—101æ›¾ç¶“æ˜¯ä¸–ç•Œæœ€é«˜çš„å»ºç¯‰ç‰©ï¼Œç¾åœ¨ä»ç„¶æ˜¯å°ç£çš„è±¡å¾µï¼å¾é€™è£¡å‡ºç™¼çš„ç¡çœ èˆªç­ï¼Œå°±åƒå¾é›²ç«¯é–‹å§‹ä½ çš„å¤¢å¢ƒä¹‹æ—…ã€‚",
                        "å°åŒ—çš„å¤œå¸‚æ–‡åŒ–èåä¸–ç•Œï¼Œå¾å£«æ—å¤œå¸‚åˆ°é¥’æ²³å¤œå¸‚ï¼Œæ¯å€‹å¤œæ™šéƒ½å……æ»¿äº†ç¾é£Ÿçš„é¦™æ°£ã€‚ä»Šæ™šçš„ç¡çœ èˆªç­ï¼Œæˆ–è¨±æœƒå¸¶ä½ åˆ°å¦ä¸€å€‹ç¾é£Ÿå¤©å ‚ï¼",
                        "å°åŒ—çš„æ·é‹ç³»çµ±è¢«è­½ç‚ºäºæ´²æœ€ä¹¾æ·¨çš„åœ°éµä¹‹ä¸€ï¼Œæ¯å¤©è¼‰é€æ•¸ç™¾è¬äººã€‚å°±åƒæˆ‘å€‘çš„ç¡çœ èˆªç­ï¼Œæº–æ™‚ã€èˆ’é©ã€å¸¶ä½ åˆ°é”ç›®çš„åœ°ã€‚",
                        "å°åŒ—çš„å°ç± åŒ…æ˜¯å…¨ä¸–ç•Œæœ€å—æ­¡è¿çš„ä¸­å¼é»å¿ƒä¹‹ä¸€ï¼Œè–„è–„çš„çš®åŒ…è£¹è‘—é®®ç¾çš„æ¹¯æ±ã€‚ä»Šæ™šçš„ç¡çœ èˆªç­ï¼Œæˆ–è¨±æœƒå¸¶ä½ å“åšå…¶ä»–åœ‹å®¶çš„ç¾é£Ÿï¼",
                        "å°åŒ—çš„æ°£å€™å››å­£å¦‚æ˜¥ï¼Œå°±åƒæˆ‘å€‘çš„ç¡çœ èˆªç­ç³»çµ±ä¸€æ¨£ï¼Œç¸½æ˜¯ç‚ºä½ æä¾›æœ€èˆ’é©çš„é«”é©—ã€‚ç„¡è«–é£›åˆ°å“ªè£¡ï¼Œéƒ½å¸¶è‘—å°åŒ—çš„æº«æš–ã€‚",
                        "å°åŒ—æ˜¯äºæ´²çš„ç§‘æŠ€é‡é®ï¼Œå¾é€™è£¡å‡ºç™¼çš„ç¡çœ èˆªç­ï¼Œå°±åƒæ­è¼‰è‘—æœ€æ–°çš„ç§‘æŠ€ï¼Œå¸¶ä½ æ¢ç´¢ä¸–ç•Œçš„æ¯ä¸€å€‹è§’è½ã€‚",
                        "å°åŒ—çš„å’–å•¡æ–‡åŒ–éå¸¸èˆˆç››ï¼Œå¾å‚³çµ±çš„æ³¡æ²«ç´…èŒ¶åˆ°ç¾ä»£çš„ç²¾å“å’–å•¡ã€‚ä»Šæ™šçš„ç¡çœ èˆªç­ï¼Œæˆ–è¨±æœƒå¸¶ä½ åˆ°å’–å•¡çš„æ•…é„‰ï¼",
                        "å°åŒ—çš„æ›¸åº—å¯†åº¦æ˜¯å…¨ä¸–ç•Œæœ€é«˜çš„ï¼Œé€™è£¡çš„äººå€‘ç†±æ„›é–±è®€ã€‚ä»Šæ™šçš„ç¡çœ èˆªç­ï¼Œå°±åƒä¸€æœ¬æ‰“é–‹çš„æ›¸ï¼Œå¸¶ä½ æ¢ç´¢æ–°çš„æ•…äº‹ã€‚"
                    ];
                    
                    const randomFact = taipeiFacts[Math.floor(Math.random() * taipeiFacts.length)];
                    
                    document.getElementById('aiContentText').innerHTML = `
                        <div class="ai-fact">
                            <div class="fact-icon">ğŸ’¡</div>
                            <div class="fact-text">${randomFact}</div>
                        </div>
                    `;
                    
                    this.log('AIå°åŒ—å°çŸ¥è­˜ç”Ÿæˆå®Œæˆ');
                    
                } catch (error) {
                    document.getElementById('aiContentText').innerHTML = `
                        <div class="ai-fact">
                            <div class="fact-icon">ğŸ®</div>
                            <div class="fact-text">å°åŒ—æ˜¯å°ç£çš„é¦–éƒ½ï¼Œæ“æœ‰è±å¯Œçš„æ–‡åŒ–å’Œç¾é£Ÿã€‚å¾é€™è£¡å‡ºç™¼çš„ç¡çœ èˆªç­ï¼Œå°‡å¸¶ä½ æ¢ç´¢äºæ´²çš„ç²¾å½©ï¼</div>
                        </div>
                    `;
                    this.log('AIå…§å®¹ç”Ÿæˆå¤±æ•—ï¼Œä½¿ç”¨é è¨­å…§å®¹');
                }
            }

            setupTaipeiFeatures() {
                const features = document.querySelectorAll('.feature-item');
                features.forEach(feature => {
                    feature.addEventListener('click', () => {
                        const featureText = feature.querySelector('.feature-text').textContent;
                        this.log(`é»æ“Šå°åŒ—ç‰¹è‰²ï¼š${featureText}`);
                        
                        // æ·»åŠ é»æ“Šæ•ˆæœ
                        feature.style.transform = 'scale(0.95)';
                        setTimeout(() => {
                            feature.style.transform = '';
                        }, 150);
                        
                        // ç”Ÿæˆç›¸é—œçš„AIå…§å®¹
                        this.generateFeatureContent(featureText);
                    });
                });
            }

            async generateFeatureContent(feature) {
                const featureContents = {
                    'å¤œå¸‚æ–‡åŒ–': 'å°åŒ—çš„å¤œå¸‚æ˜¯å°ç£æ–‡åŒ–çš„ç²¾é«“ï¼å¾èšµä»”ç…åˆ°çç å¥¶èŒ¶ï¼Œæ¯å€‹æ”¤ä½éƒ½æœ‰è‘—ç¨ç‰¹çš„æ•…äº‹ã€‚ä»Šæ™šçš„ç¡çœ èˆªç­ï¼Œæˆ–è¨±æœƒå¸¶ä½ åˆ°å…¶ä»–åœ‹å®¶çš„ç¾é£Ÿè¡—ï¼',
                    '101å¤§æ¨“': 'å°åŒ—101ä¸åªæ˜¯å»ºç¯‰ï¼Œæ›´æ˜¯å°ç£äººçš„é©•å‚²ï¼å¾é€™è£¡ä¿¯ç°æ•´å€‹å°åŒ—ï¼Œå°±åƒå¾é›²ç«¯é–‹å§‹ä½ çš„ç¡çœ èˆªç­ä¹‹æ—…ã€‚',
                    'å°ç± åŒ…': 'å°åŒ—çš„å°ç± åŒ…æ˜¯å…¨ä¸–ç•Œæœ€å—æ­¡è¿çš„ä¸­å¼é»å¿ƒï¼è–„è–„çš„çš®åŒ…è£¹è‘—é®®ç¾çš„æ¹¯æ±ï¼Œå°±åƒæˆ‘å€‘çš„ç¡çœ èˆªç­ï¼Œç²¾ç·»è€Œæº«æš–ã€‚',
                    'æ·é‹ç³»çµ±': 'å°åŒ—æ·é‹æ˜¯äºæ´²æœ€ä¹¾æ·¨çš„åœ°éµä¹‹ä¸€ï¼æ¯å¤©è¼‰é€æ•¸ç™¾è¬äººï¼Œå°±åƒæˆ‘å€‘çš„ç¡çœ èˆªç­ï¼Œæº–æ™‚ã€èˆ’é©ã€å¸¶ä½ åˆ°é”ç›®çš„åœ°ã€‚'
                };
                
                const content = featureContents[feature] || 'å°åŒ—æ˜¯ä¸€å€‹å……æ»¿æ´»åŠ›çš„åŸå¸‚ï¼Œæ¯å€‹è§’è½éƒ½æœ‰è‘—ç¨ç‰¹çš„æ•…äº‹ï¼';
                
                document.getElementById('aiContentText').innerHTML = `
                    <div class="ai-fact">
                        <div class="fact-icon">ğŸ¯</div>
                        <div class="fact-text">${content}</div>
                    </div>
                `;
                
                this.log(`ç”Ÿæˆ${feature}ç›¸é—œå…§å®¹`);
            }

            // ç²å–æ‰€æœ‰50å€‹åœ‹å®¶çš„åŸå¸‚æ•¸æ“š
            getAllCities() {
                return [
                    // äºæ´²
                    { id: 'tokyo', name: 'æ±äº¬', country: 'æ—¥æœ¬', countryCode: 'JP', latitude: 35.6762, longitude: 139.6503, timezone: 9 },
                    { id: 'seoul', name: 'é¦–çˆ¾', country: 'éŸ“åœ‹', countryCode: 'KR', latitude: 37.5665, longitude: 126.9780, timezone: 9 },
                    { id: 'bangkok', name: 'æ›¼è°·', country: 'æ³°åœ‹', countryCode: 'TH', latitude: 13.7563, longitude: 100.5018, timezone: 7 },
                    { id: 'singapore', name: 'æ–°åŠ å¡', country: 'æ–°åŠ å¡', countryCode: 'SG', latitude: 1.3521, longitude: 103.8198, timezone: 8 },
                    { id: 'hongkong', name: 'é¦™æ¸¯', country: 'é¦™æ¸¯', countryCode: 'HK', latitude: 22.3193, longitude: 114.1694, timezone: 8 },
                    { id: 'manila', name: 'é¦¬å°¼æ‹‰', country: 'è²å¾‹è³“', countryCode: 'PH', latitude: 14.5995, longitude: 120.9842, timezone: 8 },
                    { id: 'kualalumpur', name: 'å‰éš†å¡', country: 'é¦¬ä¾†è¥¿äº', countryCode: 'MY', latitude: 3.1390, longitude: 101.6869, timezone: 8 },
                    { id: 'jakarta', name: 'é›…åŠ é”', country: 'å°å°¼', countryCode: 'ID', latitude: -6.2088, longitude: 106.8456, timezone: 7 },
                    { id: 'hochiminh', name: 'èƒ¡å¿—æ˜å¸‚', country: 'è¶Šå—', countryCode: 'VN', latitude: 10.8231, longitude: 106.6297, timezone: 7 },
                    { id: 'hanoi', name: 'æ²³å…§', country: 'è¶Šå—', countryCode: 'VN', latitude: 21.0285, longitude: 105.8542, timezone: 7 },
                    { id: 'yangon', name: 'ä»°å…‰', country: 'ç·¬ç”¸', countryCode: 'MM', latitude: 16.8661, longitude: 96.1951, timezone: 6.5 },
                    { id: 'phnompenh', name: 'é‡‘é‚Š', country: 'æŸ¬åŸ”å¯¨', countryCode: 'KH', latitude: 11.5564, longitude: 104.9282, timezone: 7 },
                    { id: 'vientiane', name: 'æ°¸ç', country: 'å¯®åœ‹', countryCode: 'LA', latitude: 17.9757, longitude: 102.6331, timezone: 7 },
                    { id: 'kathmandu', name: 'åŠ å¾·æ»¿éƒ½', country: 'å°¼æ³Šçˆ¾', countryCode: 'NP', latitude: 27.7172, longitude: 85.3240, timezone: 5.75 },
                    { id: 'dhaka', name: 'é”å¡', country: 'å­ŸåŠ æ‹‰', countryCode: 'BD', latitude: 23.8103, longitude: 90.4125, timezone: 6 },
                    { id: 'colombo', name: 'å¯å€«å¡', country: 'æ–¯é‡Œè˜­å¡', countryCode: 'LK', latitude: 6.9271, longitude: 79.8612, timezone: 5.5 },
                    { id: 'maldives', name: 'é¦¬ç´¯', country: 'é¦¬çˆ¾åœ°å¤«', countryCode: 'MV', latitude: 4.1755, longitude: 73.5093, timezone: 5 },
                    { id: 'kabul', name: 'å–€å¸ƒçˆ¾', country: 'é˜¿å¯Œæ±—', countryCode: 'AF', latitude: 34.5553, longitude: 69.2075, timezone: 4.5 },
                    { id: 'islamabad', name: 'ä¼Šæ–¯è˜­å ¡', country: 'å·´åŸºæ–¯å¦', countryCode: 'PK', latitude: 33.6844, longitude: 73.0479, timezone: 5 },
                    
                    // æ±äº
                    { id: 'beijing', name: 'åŒ—äº¬', country: 'ä¸­åœ‹', countryCode: 'CN', latitude: 39.9042, longitude: 116.4074, timezone: 8 },
                    { id: 'shanghai', name: 'ä¸Šæµ·', country: 'ä¸­åœ‹', countryCode: 'CN', latitude: 31.2304, longitude: 121.4737, timezone: 8 },
                    { id: 'guangzhou', name: 'å»£å·', country: 'ä¸­åœ‹', countryCode: 'CN', latitude: 23.1291, longitude: 113.2644, timezone: 8 },
                    { id: 'shenzhen', name: 'æ·±åœ³', country: 'ä¸­åœ‹', countryCode: 'CN', latitude: 22.5431, longitude: 114.0579, timezone: 8 },
                    { id: 'macau', name: 'æ¾³é–€', country: 'æ¾³é–€', countryCode: 'MO', latitude: 22.1987, longitude: 113.5439, timezone: 8 },
                    
                    // å¤§æ´‹æ´²
                    { id: 'sydney', name: 'é›ªæ¢¨', country: 'æ¾³æ´²', countryCode: 'AU', latitude: -33.8688, longitude: 151.2093, timezone: 10 },
                    { id: 'melbourne', name: 'å¢¨çˆ¾æœ¬', country: 'æ¾³æ´²', countryCode: 'AU', latitude: -37.8136, longitude: 144.9631, timezone: 10 },
                    { id: 'brisbane', name: 'å¸ƒé‡Œæ–¯æœ¬', country: 'æ¾³æ´²', countryCode: 'AU', latitude: -27.4698, longitude: 153.0251, timezone: 10 },
                    { id: 'perth', name: 'ä¼¯æ–¯', country: 'æ¾³æ´²', countryCode: 'AU', latitude: -31.9505, longitude: 115.8605, timezone: 8 },
                    { id: 'auckland', name: 'å¥§å…‹è˜­', country: 'ç´è¥¿è˜­', countryCode: 'NZ', latitude: -36.8485, longitude: 174.7633, timezone: 12 },
                    { id: 'wellington', name: 'å¨éˆé “', country: 'ç´è¥¿è˜­', countryCode: 'NZ', latitude: -41.2924, longitude: 174.7787, timezone: 12 },
                    { id: 'portmoresby', name: 'è«çˆ¾èŒ²æ¯”æ¸¯', country: 'å·´å¸ƒäºç´å¹¾å…§äº', countryCode: 'PG', latitude: -9.4438, longitude: 147.1803, timezone: 10 },
                    { id: 'suva', name: 'è˜‡ç“¦', country: 'æ–æ¿Ÿ', countryCode: 'FJ', latitude: -18.1248, longitude: 178.4501, timezone: 12 },
                    
                    // æ­æ´²
                    { id: 'london', name: 'å€«æ•¦', country: 'è‹±åœ‹', countryCode: 'GB', latitude: 51.5074, longitude: -0.1278, timezone: 0 },
                    { id: 'paris', name: 'å·´é»', country: 'æ³•åœ‹', countryCode: 'FR', latitude: 48.8566, longitude: 2.3522, timezone: 1 },
                    { id: 'berlin', name: 'æŸæ—', country: 'å¾·åœ‹', countryCode: 'DE', latitude: 52.5200, longitude: 13.4050, timezone: 1 },
                    { id: 'rome', name: 'ç¾…é¦¬', country: 'ç¾©å¤§åˆ©', countryCode: 'IT', latitude: 41.9028, longitude: 12.4964, timezone: 1 },
                    { id: 'madrid', name: 'é¦¬å¾·é‡Œ', country: 'è¥¿ç­ç‰™', countryCode: 'ES', latitude: 40.4168, longitude: -3.7038, timezone: 1 },
                    { id: 'amsterdam', name: 'é˜¿å§†æ–¯ç‰¹ä¸¹', country: 'è·è˜­', countryCode: 'NL', latitude: 52.3676, longitude: 4.9041, timezone: 1 },
                    { id: 'zurich', name: 'è˜‡é»ä¸–', country: 'ç‘å£«', countryCode: 'CH', latitude: 47.3769, longitude: 8.5417, timezone: 1 },
                    { id: 'vienna', name: 'ç¶­ä¹Ÿç´', country: 'å¥§åœ°åˆ©', countryCode: 'AT', latitude: 48.2082, longitude: 16.3738, timezone: 1 },
                    { id: 'moscow', name: 'è«æ–¯ç§‘', country: 'ä¿„ç¾…æ–¯', countryCode: 'RU', latitude: 55.7558, longitude: 37.6176, timezone: 3 },
                    
                    // ç¾æ´²
                    { id: 'newyork', name: 'ç´ç´„', country: 'ç¾åœ‹', countryCode: 'US', latitude: 40.7128, longitude: -74.0060, timezone: -5 },
                    { id: 'losangeles', name: 'æ´›æ‰ç£¯', country: 'ç¾åœ‹', countryCode: 'US', latitude: 34.0522, longitude: -118.2437, timezone: -8 },
                    { id: 'toronto', name: 'å¤šå€«å¤š', country: 'åŠ æ‹¿å¤§', countryCode: 'CA', latitude: 43.6532, longitude: -79.3832, timezone: -5 },
                    { id: 'vancouver', name: 'æº«å“¥è¯', country: 'åŠ æ‹¿å¤§', countryCode: 'CA', latitude: 49.2827, longitude: -123.1207, timezone: -8 },
                    { id: 'mexicocity', name: 'å¢¨è¥¿å“¥åŸ', country: 'å¢¨è¥¿å“¥', countryCode: 'MX', latitude: 19.4326, longitude: -99.1332, timezone: -6 },
                    { id: 'saopaulo', name: 'è–ä¿ç¾…', country: 'å·´è¥¿', countryCode: 'BR', latitude: -23.5505, longitude: -46.6333, timezone: -3 },
                    { id: 'riodejaneiro', name: 'é‡Œç´„ç†±å…§ç›§', country: 'å·´è¥¿', countryCode: 'BR', latitude: -22.9068, longitude: -43.1729, timezone: -3 },
                    { id: 'buenosaires', name: 'å¸ƒå®œè«¾æ–¯è‰¾åˆ©æ–¯', country: 'é˜¿æ ¹å»·', countryCode: 'AR', latitude: -34.6118, longitude: -58.3960, timezone: -3 },
                    { id: 'lima', name: 'åˆ©é¦¬', country: 'ç§˜é­¯', countryCode: 'PE', latitude: -12.0464, longitude: -77.0428, timezone: -5 },
                    { id: 'santiago', name: 'è–åœ°ç‰™å“¥', country: 'æ™ºåˆ©', countryCode: 'CL', latitude: -33.4489, longitude: -70.6693, timezone: -3 }
                ];
            }

            // ç²å–ç•¶å‰ä½ç½®
            getCurrentLocation() {
                // å¯ä»¥å¾ç”¨æˆ¶è¨­ç½®ã€GPSæˆ–é è¨­ä½ç½®ç²å–
                // ç›®å‰é è¨­ç‚ºå°åŒ—ï¼Œæœªä¾†å¯ä»¥æ“´å±•æ”¯æŒå¤šå€‹èµ·å§‹ä½ç½®
                return {
                    name: 'å°åŒ—',
                    country: 'å°ç£',
                    coordinates: [25.0330, 121.5654],
                    timezone: 8
                };
            }
        }

        // å…¨åŸŸå‡½æ•¸
        let sleepFlightDemo;

        function loadDestinations() {
            sleepFlightDemo.loadDestinations();
        }

        function confirmTicket() {
            sleepFlightDemo.confirmTicket();
        }

        function clearSelection() {
            sleepFlightDemo.clearSelection();
        }

        function testBoardingAnnouncement() {
            if (sleepFlightDemo.selectedDestination) {
                sleepFlightDemo.playBoardingAnnouncement(sleepFlightDemo.selectedDestination);
            } else {
                alert('è«‹å…ˆé¸æ“‡ç›®çš„åœ°');
            }
        }

        function testLandingAnnouncement() {
            sleepFlightDemo.playLandingAnnouncement();
        }

        function clearLog() {
            sleepFlightDemo.clearLog();
        }

        function refreshAIContent() {
            document.getElementById('aiContentText').innerHTML = '<div class="loading-ai">ğŸ”„ AIæ­£åœ¨ç”Ÿæˆæ–°çš„å°åŒ—å°çŸ¥è­˜...</div>';
            sleepFlightDemo.generateAIContent();
        }

        // å›ºå®šå³ä¸‹è§’æŒ‰éˆ•é»æ“Š
        function handleActionButton() {
            if (!sleepFlightDemo) {
                alert('ç³»çµ±å°šæœªåˆå§‹åŒ–');
                return;
            }
            if (sleepFlightDemo.selectedDestination) {
                sleepFlightDemo.playBoardingAnnouncement(sleepFlightDemo.selectedDestination);
                alert('âœˆï¸ æº–å‚™èµ·é£›ï¼\nç›®çš„åœ°ï¼š' + sleepFlightDemo.selectedDestination.name + '');
            } else {
                alert('è«‹å…ˆé¸æ“‡ç›®çš„åœ°å†èµ·é£›');
            }
        }

        async function debugDestinations() {
            console.log('=== èª¿è©¦ç›®çš„åœ°è¨ˆç®— ===');
            console.log('ç•¶å‰èµ·åºŠæ™‚é–“:', sleepFlightDemo.wakeTime);
            console.log('ç•¶å‰ä½ç½®:', sleepFlightDemo.currentLocation);
            
            const destinations = sleepFlightDemo.calculateSleepFlightDestinations();
            console.log('è¨ˆç®—å‡ºçš„ç›®çš„åœ°:', destinations);
            
            // ç›´æ¥åœ¨é é¢ä¸Šé¡¯ç¤ºèª¿è©¦ä¿¡æ¯
            const grid = document.getElementById('destinationGrid');
            grid.innerHTML = `
                <div style="background: rgba(255,255,255,0.1); padding: 20px; border-radius: 10px; margin-bottom: 10px;">
                    <h4 style="color: #00ff88; margin-bottom: 10px;">ğŸ› èª¿è©¦ä¿¡æ¯</h4>
                    <p><strong>èµ·åºŠæ™‚é–“:</strong> ${sleepFlightDemo.wakeTime}</p>
                    <p><strong>è¨ˆç®—å‡ºçš„ç›®çš„åœ°æ•¸é‡:</strong> ${destinations.length}</p>
                    <p><strong>ç›®çš„åœ°åˆ—è¡¨:</strong></p>
                    <ul style="margin-left: 20px;">
                        ${destinations.map(dest => `<li>${dest.flag} ${dest.name} (${dest.country}) - ${dest.distance}km - NT$${dest.price}</li>`).join('')}
                    </ul>
                </div>
            `;
            
            // ç„¶å¾Œæ­£å¸¸æ¸²æŸ“ç›®çš„åœ°
            await sleepFlightDemo.renderDestinations();
        }

        async function testDestinations() {
            console.log('=== æ¸¬è©¦ç›®çš„åœ° ===');
            
            // ç›´æ¥ä½¿ç”¨å‰4å€‹åŸå¸‚ä½œç‚ºæ¸¬è©¦
            const allCities = sleepFlightDemo.getAllCities();
            const currentLocation = sleepFlightDemo.getCurrentLocation();
            
            sleepFlightDemo.destinations = allCities.slice(0, 4).map(city => ({
                id: city.id,
                name: city.name,
                country: city.country,
                countryCode: city.countryCode,
                flag: sleepFlightDemo.getCountryFlag(city.countryCode),
                distance: Math.round(sleepFlightDemo.calculateDistance(currentLocation.coordinates[0], currentLocation.coordinates[1], city.latitude, city.longitude)),
                flightTime: Math.round((sleepFlightDemo.calculateDistance(currentLocation.coordinates[0], currentLocation.coordinates[1], city.latitude, city.longitude) / 800) * 10) / 10,
                coordinates: [city.latitude, city.longitude],
                price: sleepFlightDemo.calculateFlightPrice(sleepFlightDemo.calculateDistance(currentLocation.coordinates[0], currentLocation.coordinates[1], city.latitude, city.longitude)),
                timezone: city.timezone
            }));
            
            await sleepFlightDemo.renderDestinations();
            
            console.log('æ¸¬è©¦ç›®çš„åœ°è¼‰å…¥å®Œæˆ:', sleepFlightDemo.destinations);
            sleepFlightDemo.log(`æ¸¬è©¦è¼‰å…¥ ${sleepFlightDemo.destinations.length} å€‹ç›®çš„åœ°`);
        }

        // åˆå§‹åŒ–ç³»çµ±
        document.addEventListener('DOMContentLoaded', function() {
            try {
                sleepFlightDemo = new SleepFlightDemo();
                console.log('ç¡çœ èˆªç­ç³»çµ±å·²åˆå§‹åŒ–');
                
                // æ·»åŠ æ¸¬è©¦æŒ‰éˆ•
                const testBtn = document.createElement('button');
                testBtn.textContent = 'ğŸ”§ ç³»çµ±æ¸¬è©¦';
                testBtn.onclick = function() {
                    console.log('sleepFlightDemo:', sleepFlightDemo);
                    console.log('destinations:', sleepFlightDemo.destinations);
                    console.log('currentLocation:', sleepFlightDemo.currentLocation);
                    alert('ç³»çµ±æ­£å¸¸ï¼è«‹æŸ¥çœ‹æ§åˆ¶å°');
                };
                testBtn.style.cssText = 'position: fixed; top: 10px; right: 10px; z-index: 9999; background: red; color: white; padding: 10px;';
                document.body.appendChild(testBtn);
                
                // å³ä¸‹è§’æŒ‰éˆ•é è¨­é¡¯ç¤º
                const fab = document.getElementById('fixedActionButton');
                if (fab) fab.style.display = 'block';

            } catch (error) {
                console.error('åˆå§‹åŒ–å¤±æ•—:', error);
                alert('ç³»çµ±åˆå§‹åŒ–å¤±æ•—: ' + error.message);
            }
        });
    </script>
</body>
</html>
